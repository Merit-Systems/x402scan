generator client {
  provider      = "prisma-client-js"
  output        = "../generated/client"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("TRANSFERS_DB_URL")
}

model TransferEvent {
  id               String   @default(uuid())
  address          String
  transaction_from String
  sender           String
  recipient        String
  amount           Float
  block_timestamp  DateTime
  tx_hash          String
  chain            String
  provider         String
  decimals         Int
  facilitator_id   String
  log_index        Int?

  @@id([block_timestamp, id], map: "transfer_event_pk")
  @@unique([tx_hash, log_index, chain, block_timestamp])
  @@index([block_timestamp])
  @@index([tx_hash])
  @@index([chain, block_timestamp])
  @@index([block_timestamp, facilitator_id])
  @@index([chain, block_timestamp, facilitator_id])
  @@index([sender])
  @@index([recipient])
  @@index([block_timestamp], map: "TransferEvent_block_timestamp_brin_idx", type: Brin)
  @@index([facilitator_id, block_timestamp(sort: Desc)], map: "TransferEvent_facilitator_block_timestamp_desc_idx")
  @@index([recipient, block_timestamp])
  @@index([recipient, sender, block_timestamp], map: "TransferEvent_recipient_sender_ts_idx")
  @@index([sender, block_timestamp])
}
